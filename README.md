# デバイスのカメラを利用して脈拍を測定するプログラム

 〇実装した処理
 
 - 初期状態：
 
    カウンタm=0,測定時間mt=12(sec),データ格納用の配列y,プロット用の配列x(0~mt*30が格納された配列)が宣言されている
    
- 与えられた測定時間mt(sec)の間で,毎フレームごとに以下の処理を行う

  - カメラから画像ファイルを保存する
  - y[i]にi番目のフレームの画像の輝度平均値を格納する
  - カウンタmに1を足す
  - m=mt\*30になったら処理を終える  ※今回のFPSが30だったため,総フレーム数はmt*30
- 測定結果yをxでプロットして出力する

  - 縦軸はLuminance(輝度),範囲は2~mt*30-1
  - 横軸はframe(1/30sec),範囲はyの平均値-5~yの平均値+5


〇プログラム作成時に注意した点
  - 測定開始直後からしばらくは輝度値の揺れが大きかったため,測定開始から2秒後のデータからプロットするようにした.
  - 輝度値の変化が小さいため,プロットの縦軸の範囲を狭くし,変化が見やすいようにした

〇使い方
  
    プログラムを実行した直後から12秒間カメラを指で押さえる.
    
    できるだけ明るい場所で行い,測定中は指を動かさないようにする.
  
〇実行の仕方
  
    JupyterNotebook上でプログラムを実行する.

〇実行時の動作
![gif](https://vps10-d.kuku.lu/files/20190718-0933_7ba834ff49e77f9fbd2afee2912285f2.gif)

![img](https://vps10-d.kuku.lu/files/20190718-0938_93073a2d6664937b0b22972e56352ed6.png)
  
〇依存ライブラリとバージョン
  
  - cv2(バージョン4.1.0)
  - numpy(バージョン1.11.3)
  - os
  - matplotlib.pyplot 
  - skimage.io
  
〇参考にしたサイト
  
  - Python, OpenCVでカメラのリアルタイム動画から静止画を保存(https://note.nkmk.me/python-opencv-camera-to-still-image/)
    
      "定期的に自動保存"のコードにおける,指定したフレーム数毎にカメラから画像を保存する部分を参考にした.
  - Python, OpenCVで動画再生時のFPS（フレームレート）を測定・表示(https://note.nkmk.me/python-opencv-fps-measure/)
    
      カメラに設定されたFPSを取得する以下のコードを引用し,FPS値を得た.
      ```Python
      import cv2

      cap = cv2.VideoCapture(0)

      print(cap.get(cv2.CAP_PROP_FPS))
      ```
      
   
